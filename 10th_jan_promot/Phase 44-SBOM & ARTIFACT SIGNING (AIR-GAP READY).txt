PROMPT 5 ‚Äî SBOM & ARTIFACT SIGNING (AIR-GAP READY)

(MANDATORY GA GATE ‚Äî MILITARY / GOV REQUIREMENT)

PROMPT START

You are working on RansomEye v1.0 GA ‚Äì Audit Remediation Phase.
This is Phase B / F: Supply Chain & Artifact Integrity Hardening.

üîí GLOBAL CONSTRAINTS (MANDATORY)

v1.0 GA hardening only

NO new features

NO build-system redesign

NO runtime behavior changes

Offline / air-gapped verification must be possible

Fail-closed installation

TASK 5 ‚Äî SBOM GENERATION & ARTIFACT SIGNING (GA BLOCKER)
Objective

Enable offline, cryptographic verification of everything shipped to a customer.

An air-gapped military or government customer must be able to:

Inspect what is inside the release

Verify nothing was tampered with

Install only if verification succeeds

REQUIRED IMPLEMENTATION (STRICT)
1. Generate SBOM (manifest.json)

At build time, generate a machine-readable SBOM listing every shipped artifact.

Manifest MUST include for each artifact:

Artifact name

Artifact path (relative)

SHA256 hash

Artifact type (core, linux_agent, windows_agent, dpi_probe, etc.)

Example structure (illustrative):

{
  "version": "1.0.0",
  "build_id": "...",
  "artifacts": [
    {
      "name": "ransomeye-core",
      "path": "bin/core",
      "sha256": "...",
      "type": "core"
    }
  ]
}

2. Cryptographic Signing (ed25519)

Generate a manifest.json.sig using ed25519

Signature must cover the entire manifest.json

No placeholder keys

No test keys

Signing key must not be embedded in binaries

3. Installer Enforcement (FAIL-CLOSED)

Installer MUST:

Verify manifest.json.sig

Verify each artifact‚Äôs SHA256

Refuse installation if:

Signature invalid

Any artifact hash mismatch

Manifest missing

No warnings. No overrides.

HARD RULES

‚ùå No unsigned artifacts

‚ùå No ‚Äúbest effort‚Äù install

‚ùå No network access required for verification

‚úÖ Offline verification only

‚úÖ Deterministic manifest generation

DELIVERABLES

SBOM generation logic (build step or script)

Signing logic (ed25519)

Installer verification logic

File paths modified/added

Example manifest.json (redacted if needed)

ACCEPTANCE CRITERIA (GA BLOCKING)

Air-gapped system can verify artifacts offline

Tampered artifact ‚Üí install fails

Invalid signature ‚Üí install fails

Correct bundle ‚Üí install succeeds

Respond only with:

Implementation approach

File paths

Key code excerpts

Confirmation of offline verification & fail-closed behavior

PROMPT END
