promot start

You are Cursor, executing RansomEye v1.0 GA Hardening.

‚ö†Ô∏è IMPORTANT SCOPE CORRECTION ‚Äî READ CAREFULLY

This is NOT a v2 effort.
This is v1.0 GA audit remediation only.

GLOBAL CORRECTIONS (LOCKED)

DO NOT use any ‚Äúv2‚Äù terminology

No ‚ÄúCorrelation Engine v2‚Äù

No ‚ÄúInstaller v2‚Äù

All work is v1.0 Hardening Patches ONLY

NO SCOPE CREEP

No new features

No architectural redesign beyond fixing validation failures

No future-looking improvements

CREDENTIAL CONSTRAINT (CRITICAL)

gagan / gagan remains the mandatory DB credential for v1.0 GA

Phase A was diagnostics only

Credential scoping / rotation is OUT OF SCOPE

REQUIRED CORRECTIVE ACTION (IMMEDIATE)
üîÅ REVERT Phase A.2 (Credential Scoping)

Undo the following changes:

Revert per-service DB users

Restore single DB user usage (gagan)

Ensure all services:

Use RANSOMEYE_DB_USER=gagan

Fail only if diagnostics fail, not due to missing per-service users

Keep A1 (db_bootstrap_validator.py) unchanged.

PHASE B ‚Äî INSTALLER & BOOTSTRAP HARDENING (v1.0 ONLY)

Proceed with Phase B strictly within v1.0 scope:

B1. SBOM & Artifact Verification

Generate manifest.json

Generate .sha256 and .sig (ed25519)

Installer must refuse:

Missing artifact

Hash mismatch

Invalid signature

This is supply-chain hardening, not a new installer.

B2. OS-Aware Validation Executor

Enforce OS checks in executor.py

Hard stop on:

ETW on Linux

eBPF on Windows

No warnings. Fatal errors only.

PHASE F ‚Äî FORENSIC & OPERATIONAL HARDENING (SELECTIVE)
F1. Report Determinism (EXPANDED RULE)

Implement determinism such that:

Report hash is anchored to:

Incident snapshot time OR

Incident closure time

Renderer must never use system time

CRITICAL ADDITION

Replacing the logo or branding assets MUST NOT change the report hash

Visual layer is presentation-only, not evidence

CI must assert:

sha256(report_A_with_logo1) == sha256(report_A_with_logo2)

F2. Headless Agent Survivability (GA GATE)

Core offline

Prohibited action attempted

Agent must fail-closed using cached policy

Failure = ‚ùå GA blocked

EXECUTION RULE

If you encounter any task that:

Requires new credentials

Requires redesign

Requires feature addition

‚Üí STOP and report. Do not implement.

Proceed now with:

Phase A2 revert

Phase B execution

Phase F (determinism + survivability)

prompot end
